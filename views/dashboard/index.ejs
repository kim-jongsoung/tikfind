<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대시보드 - TikFind</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div id="sidebar-container"></div>
    <div id="header-container"></div>
    
    <main class="ml-64 mt-16 p-8">
        <div class="max-w-4xl mx-auto">
        <!-- Desktop App 다운로드 카드 -->
        <div class="download-card" style="position: relative; z-index: 2;">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h3 class="text-white mb-3" style="font-weight: bold; font-size: 1.8rem;">
                        <i class="fas fa-desktop me-2"></i>
                        Desktop App 다운로드
                    </h3>
                    <p class="text-white mb-0" style="opacity: 0.9; font-size: 1.1rem;">
                        TikTok Live 방송을 시작하려면 Desktop App을 다운로드하세요
                    </p>
                    <p class="text-white mt-2" style="opacity: 0.8; font-size: 0.9rem;">
                        <i class="fas fa-check-circle me-2"></i>실시간 채팅 수집
                        <i class="fas fa-check-circle ms-3 me-2"></i>AI 발음 코치
                        <i class="fas fa-check-circle ms-3 me-2"></i>신청곡 자동 수집
                    </p>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn-download" onclick="downloadApp()">
                        <i class="fas fa-download me-2"></i>
                        Windows 다운로드
                    </button>
                    <p class="text-white mt-2 mb-0" style="opacity: 0.7; font-size: 0.8rem;">
                        Mac 버전은 곧 출시됩니다
                    </p>
                </div>
            </div>
        </div>

        <!-- 대시보드 헤더 -->
        <div class="dashboard-header">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h2 class="text-white mb-2" style="font-size: 2.5rem; font-weight: bold;">
                            <i class="fas fa-tachometer-alt me-2"></i>
                            대시보드
                        </h2>
                        <p class="text-white mb-0" style="opacity: 0.8; font-size: 1.1rem;">
                            TikFind로 글로벌 방송을 시작하세요
                        </p>
                    </div>
                    <div class="col-md-4 text-end">
                        <div class="text-white">
                            <p class="mb-1" style="opacity: 0.7; font-size: 0.9rem;">플랜</p>
                            <h4 class="mb-0" style="font-weight: bold;">
                                <span id="userPlan">FREE</span>
                                <a href="/pricing" class="btn btn-sm ms-2" style="background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%); color: white; border: none;">
                                    업그레이드
                                </a>
                            </h4>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 실시간 통계 -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="stat-card live">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-white mb-1" style="opacity: 0.7; font-size: 0.9rem;">방송 상태</p>
                            <h3 class="text-white mb-0" id="liveStatus" style="font-weight: bold;">⚫ 오프라인</h3>
                        </div>
                        <div style="background: rgba(239, 68, 68, 0.2); padding: 1rem; border-radius: 50%;">
                            <i class="fas fa-broadcast-tower" style="color: #ef4444; font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card viewers">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-white mb-1" style="opacity: 0.7; font-size: 0.9rem;">시청자</p>
                            <h3 class="text-white mb-0" id="viewerCount" style="font-weight: bold;">0</h3>
                        </div>
                        <div style="background: rgba(16, 185, 129, 0.2); padding: 1rem; border-radius: 50%;">
                            <i class="fas fa-users" style="color: #10b981; font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card messages">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-white mb-1" style="opacity: 0.7; font-size: 0.9rem;">총 메시지</p>
                            <h3 class="text-white mb-0" id="messageCount" style="font-weight: bold;">0</h3>
                        </div>
                        <div style="background: rgba(59, 130, 246, 0.2); padding: 1rem; border-radius: 50%;">
                            <i class="fas fa-comments" style="color: #3b82f6; font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="stat-card gifts">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-white mb-1" style="opacity: 0.7; font-size: 0.9rem;">선물</p>
                            <h3 class="text-white mb-0" id="giftCount" style="font-weight: bold;">0</h3>
                        </div>
                        <div style="background: rgba(245, 158, 11, 0.2); padding: 1rem; border-radius: 50%;">
                            <i class="fas fa-gift" style="color: #f59e0b; font-size: 2rem;"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 빠른 작업 -->
        <h4 class="text-white mb-3" style="font-weight: bold;">
            <i class="fas fa-bolt me-2"></i>빠른 작업
        </h4>
        <div class="row mb-5">
            <div class="col-md-3 mb-3">
                <div class="quick-action-card" onclick="location.href='/dashboard/live'">
                    <div class="quick-action-icon">
                        <i class="fas fa-video"></i>
                    </div>
                    <h5 class="text-white mb-2">라이브 관리</h5>
                    <p class="text-white mb-0" style="opacity: 0.7; font-size: 0.9rem;">실시간 방송 모니터링</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="quick-action-card" onclick="location.href='/dashboard/ai'">
                    <div class="quick-action-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <h5 class="text-white mb-2">AI 설정</h5>
                    <p class="text-white mb-0" style="opacity: 0.7; font-size: 0.9rem;">발음 코치 설정</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="quick-action-card" onclick="location.href='/dashboard/settings'">
                    <div class="quick-action-icon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <h5 class="text-white mb-2">설정</h5>
                    <p class="text-white mb-0" style="opacity: 0.7; font-size: 0.9rem;">틱톡 ID 및 계정 설정</p>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="quick-action-card" onclick="location.href='/dashboard/billing'">
                    <div class="quick-action-icon">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <h5 class="text-white mb-2">결제 관리</h5>
                    <p class="text-white mb-0" style="opacity: 0.7; font-size: 0.9rem;">플랜 및 결제 내역</p>
                </div>
            </div>
        </div>
    </div>

    <%- include('../partials/footer') %>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        function downloadApp() {
            // Desktop App 다운로드 로직
            window.location.href = '/api/download-app';
        }

        // Socket.io 연결
        const socket = io();
        
        // 실시간 통계 업데이트
        socket.on('stats', (data) => {
            if (data.isLive) {
                document.getElementById('liveStatus').innerHTML = '🔴 라이브';
            } else {
                document.getElementById('liveStatus').innerHTML = '⚫ 오프라인';
            }
            document.getElementById('viewerCount').textContent = data.viewers || 0;
            document.getElementById('messageCount').textContent = data.messages || 0;
            document.getElementById('giftCount').textContent = data.gifts || 0;
        });

        // 사용자 플랜 로드
        fetch('/api/user/plan')
            .then(res => res.json())
            .then(data => {
                if (data.plan) {
                    document.getElementById('userPlan').textContent = data.plan.toUpperCase();
                }
            });
    </script>
</body>
</html>
